(function(){angular.module("locYobenApp",["ngRoute","ngSanitize","ui.bootstrap"]);function e(e,o){e.when("/",{templateUrl:"/home/home.view.html",controller:"homeCtrl",controllerAs:"vm"}).when("/about",{templateUrl:"/common/views/genericText.view.html",controller:"aboutCtrl",controllerAs:"vm"}).when("/location/:locationid",{templateUrl:"/locationDetail/locationDetail.view.html",controller:"locationDetailCtrl",controllerAs:"vm"}).when("/register",{templateUrl:"/auth/register/register.view.html",controller:"registerCtrl",controllerAs:"vm"}).when("/login",{templateUrl:"/auth/login/login.view.html",controller:"loginCtrl",controllerAs:"vm"}).otherwise({redirectTo:"/"});o.html5Mode(true)}angular.module("locYobenApp").config(["$routeProvider","$locationProvider",e])})();(function(){angular.module("locYobenApp").controller("homeCtrl",e);e.$inject=["$scope","locYobenData","geolocation"];function e(e,o,n){if(window.location.pathname!=="/"){window.location.href="/#"+window.location.pathname}var t=this;console.log(window.location);t.pageHeader={title:"LocYoben",strapline:"Find places to work with wifi near you!"};t.sidebar={content:"Looking for wifi and a seat? LocYoben helps you find places to work when out and about. Perhaps with coffee, cake or some snacks? Let LocYoben help you find the place you're looking for."};t.message="Checking your location";t.getData=function(e){var n=e.coords.latitude,a=e.coords.longitude;t.message="Searching for nearby places";o.locationByCoords(n,a).success(function(e){t.message=e.length>0?"":"No locations found nearby";t.data={locations:e};console.log(t.data)}).error(function(e){t.message="Sorry, something's gone wrong, please try again later"})};t.showError=function(o){e.$apply(function(){t.message=o.message})};t.noGeo=function(){e.$apply(function(){t.message="Geolocation is not supported by this browser."})};n.getPosition(t.getData,t.showError,t.noGeo)}})();(function(){angular.module("locYobenApp").controller("aboutCtrl",e);function e(){var e=this;e.pageHeader={title:"About LocYoben"};e.main={content:"LocYoben was created in order to complete candidature for s1 academic degree in akakom.\n\nAplikasi ini dirancang untuk memenuhi kebutuhan pengunjung kafe yang memiliki fasilitas hotspot untuk menentukan fasilitas, hidangan serta pelayanan yang ditawarkan dari masing – masing kafe, melalui aplikasi ini pengunjung juga dapat memberikan review atau feedback mengenai kafe yang mereka kunjungi menggunakan teklonogi – teknologi terbaru dalam dunia web developmen dan cloud computing seperti non-blocking io dan Single Page Application (SPA).         “Aplikasi Berbasis Web untuk Pencarian Hotspot Kafe Menggunakan MEAN Stack (MongoDb, ExpressJs, AngularJs dan NodeJs)”."}}})();(function(){angular.module("locYobenApp").controller("loginCtrl",e);e.$inject=["$location","authentication"];function e(e,o){var n=this;n.pageHeader={title:"Sign in to LocYoben"};n.credentials={email:"",password:""};n.returnPage=e.search().page||"/";n.onSubmit=function(){n.formError="";if(!n.credentials.email||!n.credentials.password){n.formError="All fields required, please try again";return false}else{n.doLogin()}};n.doLogin=function(){n.formError="";o.login(n.credentials).error(function(e){n.formError=e}).then(function(){e.search("page",null);e.path(n.returnPage)})}}})();(function(){angular.module("locYobenApp").controller("registerCtrl",e);e.$inject=["$location","authentication"];function e(e,o){var n=this;n.pageHeader={title:"Create a new LocYoben account"};n.credentials={name:"",email:"",password:""};n.returnPage=e.search().page||"/";n.onSubmit=function(){n.formError="";if(!n.credentials.name||!n.credentials.email||!n.credentials.password){n.formError="All fields required, please try again";return false}else{n.doRegister()}};n.doRegister=function(){n.formError="";o.register(n.credentials).error(function(e){n.formError=e}).then(function(){e.search("page",null);e.path(n.returnPage)})}}})();(function(){angular.module("locYobenApp").controller("locationDetailCtrl",e);e.$inject=["$routeParams","$location","$modal","locYobenData","authentication"];function e(e,o,n,t,a){var r=this;r.locationid=e.locationid;r.isLoggedIn=a.isLoggedIn();r.currentPath=o.path();t.locationById(r.locationid).success(function(e){r.data={location:e};r.pageHeader={title:r.data.location.name}}).error(function(e){console.log(e)});r.popupReviewForm=function(){var e=n.open({templateUrl:"/reviewModal/reviewModal.view.html",controller:"reviewModalCtrl as vm",resolve:{locationData:function(){return{locationid:r.locationid,locationName:r.data.location.name}}}});e.result.then(function(e){r.data.location.reviews.push(e)})}}})();(function(){angular.module("locYobenApp").controller("reviewModalCtrl",e);e.$inject=["$modalInstance","locYobenData","locationData"];function e(e,o,n){var t=this;t.locationData=n;t.onSubmit=function(){t.formError="";if(!t.formData.rating||!t.formData.reviewText){t.formError="All fields required, please try again";return false}else{t.doAddReview(t.locationData.locationid,t.formData)}};t.doAddReview=function(e,n){o.addReviewById(e,{rating:n.rating,reviewText:n.reviewText}).success(function(e){t.modal.close(e)}).error(function(e){t.formError="Your review has not been saved, please try again"});return false};t.modal={close:function(o){e.close(o)},cancel:function(){e.dismiss("cancel")}}}})();(function(){angular.module("locYobenApp").service("authentication",e);e.$inject=["$http","$window"];function e(e,o){var n=function(e){o.localStorage["locYoben-token"]=e};var t=function(){return o.localStorage["locYoben-token"]};var a=function(){var e=t();if(e){var n=JSON.parse(o.atob(e.split(".")[1]));return n.exp>Date.now()/1e3}else{return false}};var r=function(){if(a()){var e=t();var n=JSON.parse(o.atob(e.split(".")[1]));return{email:n.email,name:n.name}}};register=function(o){return e.post("/api/register",o).success(function(e){n(e.token)})};login=function(o){return e.post("/api/login",o).success(function(e){n(e.token)})};logout=function(){o.localStorage.removeItem("locYoben-token")};return{currentUser:r,saveToken:n,getToken:t,isLoggedIn:a,register:register,login:login,logout:logout}}})();(function(){angular.module("locYobenApp").service("geolocation",e);function e(){var e=function(e,o,n){if(navigator.geolocation){navigator.geolocation.getCurrentPosition(e,o)}else{n()}};return{getPosition:e}}})();(function(){angular.module("locYobenApp").service("locYobenData",e);e.$inject=["$http","authentication"];function e(e,o){var n=function(o,n){return e.get("/api/locations?lng="+n+"&lat="+o+"&maxDistance=550")};var t=function(o){return e.get("/api/locations/"+o)};var a=function(n,t){return e.post("/api/locations/"+n+"/reviews",t,{headers:{Authorization:"Bearer "+o.getToken()}})};return{locationByCoords:n,locationById:t,addReviewById:a}}})();(function(){angular.module("locYobenApp").filter("formatDistance",o);var e=function(e){return!isNaN(parseFloat(e))&&isFinite(e)};function o(){return function(o){var n,t;if(o&&e(o)){if(o>1){n=parseFloat(o).toFixed(1);t="km"}else{n=parseInt(o*1e3,10);t="m"}return n+t}else{return"?"}}}})();(function(){angular.module("locYobenApp").filter("addHtmlLineBreaks",e);function e(){return function(e){var o=e.replace(/\n/g,"<br/>");return o}}})();(function(){angular.module("locYobenApp").controller("navigationCtrl",e);e.$inject=["$location","authentication"];function e(e,o){var n=this;n.currentPath=e.path();n.isLoggedIn=o.isLoggedIn();n.currentUser=o.currentUser();n.logout=function(){o.logout();e.path("/")}}})();(function(){angular.module("locYobenApp").directive("navigation",e);function e(){return{restrict:"EA",templateUrl:"/common/directives/navigation/navigation.template.html",controller:"navigationCtrl as navvm"}}})();(function(){angular.module("locYobenApp").directive("footerGeneric",e);function e(){return{restrict:"EA",templateUrl:"/common/directives/footerGeneric/footerGeneric.template.html"}}})();(function(){angular.module("locYobenApp").directive("pageHeader",e);function e(){return{restrict:"EA",scope:{content:"=content"},templateUrl:"/common/directives/pageHeader/pageHeader.template.html"}}})();(function(){angular.module("locYobenApp").directive("ratingStars",e);function e(){return{restrict:"EA",scope:{thisRating:"=rating"},templateUrl:"/common/directives/ratingStars/ratingStars.template.html"}}})();